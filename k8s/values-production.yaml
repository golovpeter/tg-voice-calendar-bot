# Production values для tg-calendar-bot
# Использование: helm install tg-calendar-bot . -f values-production.yaml

# Общие настройки
fullnameOverride: ""

# Namespace
namespace:
  create: true
  name: tg-calendar-bot

# Настройки образа бота
image:
  repository: tg-calendar-bot
  pullPolicy: IfNotPresent
  tag: "latest"

imagePullSecrets:
  - name: regcred  # Если нужен pull secret для private registry

# Настройки бота
bot:
  replicas: 2  # Несколько реплик для высокой доступности
  
  resources:
    requests:
      memory: "512Mi"
      cpu: "300m"
    limits:
      memory: "1Gi"
      cpu: "1000m"
  
  env:
    gigachatModel: "GigaChat-2-Pro"
  
  livenessProbe:
    enabled: true
    initialDelaySeconds: 30
    periodSeconds: 30
    timeoutSeconds: 5
  
  readinessProbe:
    enabled: true
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 5

# Настройки Redis
redis:
  enabled: true
  name: redis
  
  image:
    repository: redis
    tag: "7-alpine"
    pullPolicy: IfNotPresent
  
  replicas: 1
  
  # Включить персистентное хранилище для production
  persistence:
    enabled: true
    size: 5Gi
    storageClass: "standard"  # Замените на ваш StorageClass
    accessMode: ReadWriteOnce
  
  resources:
    requests:
      memory: "256Mi"
      cpu: "200m"
    limits:
      memory: "512Mi"
      cpu: "500m"
  
  config:
    save: "60 1"
    loglevel: "warning"
    appendonly: "yes"

# Secrets должны быть установлены через --set или отдельный файл
# НЕ храните секреты в этом файле в git!
secrets:
  telegramBotToken: ""  # Установите через --set или отдельный values файл
  gigachatAuthKey: ""   # Установите через --set или отдельный values файл
  googleCredentials: ""  # Установите через --set или отдельный values файл

# ConfigMap
configMap:
  gigachatModel: "GigaChat-2-Pro"

# ServiceAccount
serviceAccount:
  create: true
  name: ""

# Pod Security Context
podSecurityContext:
  fsGroup: 1000
  runAsNonRoot: true
  runAsUser: 1000

# Security Context
securityContext:
  capabilities:
    drop:
    - ALL
  readOnlyRootFilesystem: false  # Может потребоваться true, если приложение поддерживает
  allowPrivilegeEscalation: false

